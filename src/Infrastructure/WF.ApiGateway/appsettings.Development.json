{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "Redis": {
    "Host": "localhost",
    "Port": 6379
  },
  "IpRateLimiting": {
    "EnableEndpointRateLimiting": true,
    "StackBlockedRequests": false,
    "RealIpHeader": "X-Real-IP",
    "HttpStatusCode": 429,
    "GeneralRules": [
      {
        "Endpoint": "*",
        "Period": "1m",
        "Limit": 60
      },
      {
        "Endpoint": "*:/api/v*/auth/*",
        "Period": "1m",
        "Limit": 10
      }
    ]
  },
  "IpRateLimitPolicies": {
    "IpRules": []
  },
  "ReverseProxy": {
    "Routes": {
      "customer-public-route": {
        "ClusterId": "customer-cluster",
        "Match": {
          "Path": "/api/v{version:int}/customers/{**remainder}"
        },
        "Transforms": [ { "PathPattern": "/api/v{version}/customers/{**remainder}" } ]
      },
      "customer-admin-route": {
        "ClusterId": "customer-cluster",
        "Match": {
          "Path": "/api/v{version:int}/admin/customers/{**remainder}"
        }
      },
      "fraud-route": {
        "ClusterId": "fraud-cluster",
        "Match": {
          "Path": "/api/v{version:int}/frauds/{**remainder}"
        },
        "Transforms": [ { "PathPattern": "/api/v{version}/frauds/{**remainder}" } ]
      },
      "wallet-route": {
        "ClusterId": "wallet-cluster",
        "Match": {
          "Path": "/api/v{version:int}/wallets/{**remainder}"
        },
        "Transforms": [ { "PathPattern": "/api/v{version}/wallets/{**remainder}" } ]
      },
      "transaction-route": {
        "ClusterId": "transaction-cluster",
        "Match": {
          "Path": "/api/v{version:int}/transactions/{**remainder}"
        },
        "Transforms": [ { "PathPattern": "/api/v{version}/transactions/{**remainder}" } ]
      },
      "transaction-admin-route": {
        "ClusterId": "transaction-cluster",
        "Match": {
          "Path": "/api/v{version:int}/admin/transactions/{**remainder}"
        }
      },
      "auth-register-route": {
        "ClusterId": "customer-cluster",
        "Match": {
          "Path": "/api/v{version}/auth/register",
          "Methods": [ "POST" ]
        },
        "Transforms": [
          {
            "PathPattern": "/api/v{version}/customers"
          }
        ]
      },
      "auth-login-route": {
        "ClusterId": "identity-cluster",
        "Match": {
          "Path": "/api/v{version:int}/auth/login"
        },
        "Transforms": [
          {
            "PathPattern": "/realms/wallet-realm/protocol/openid-connect/token"
          }
        ]
      },
      "identity-route": {
        "ClusterId": "identity-cluster",
        "Match": {
          "Path": "/realms/{**remainder}"
        },
        "Transforms": [
          { "PathPattern": "/realms/{**remainder}" }
        ]
      }
    },
    "Clusters": {
      "customer-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:7001"
          }
        }
      },
      "fraud-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:7002"
          }
        }
      },
      "transaction-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:7003"
          }
        }
      },
      "wallet-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:7004"
          }
        }
      },
      "identity-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "http://localhost:8080"
          }
        }
      }
    }
  }
}
